<?xml version="1.0" encoding="UTF-8"?>
<chapter xml:id="ch19-inference-single-mean" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Inference for a single mean</title>

  <introduction>
    <p>Focusing now on Statistical Inference for <alert>numerical data</alert><idx>numerical data</idx>, again, we will revisit and expand upon the foundational aspects of hypothesis testing from <xref ref="ch11-hypothesis-testing-randomization"/>.</p>

    <p>The important data structure for this chapter is a numeric response variable (that is, the outcome is quantitative). The four data structures we detail are one numeric response variable, one numeric response variable which is a difference across a pair of observations, a numeric response variable broken down by a binary explanatory variable, and a numeric response variable broken down by an explanatory variable that has two or more levels. When appropriate, each of the data structures will be analyzed using the three methods from <xref ref="ch11-hypothesis-testing-randomization"/>, <xref ref="ch12-confidence-intervals-bootstrapping"/>, and <xref ref="sec-foundations-mathematical"/>: randomization test, bootstrapping, and mathematical models, respectively.</p>

    <p>As we build on the inferential ideas, we will visit new foundational concepts in statistical inference. One key new idea rests in estimating how the sample mean (as opposed to the sample proportion) varies from sample to sample; the resulting value is referred to as the standard error of the mean. We will also introduce a new important mathematical model, the <m>t</m>-distribution (as the foundation for the <m>t</m>-test).</p>
  </introduction>

  <p>In this chapter, we focus on the sample mean (instead of, for example, the sample median or the range of the observations) because of the well-studied mathematical model which describes the behavior of the sample mean. We will not cover mathematical models which describe other statistics, but the bootstrap and randomization techniques described below are immediately extendable to any function of the observed data. The sample mean will be calculated in one group, two paired groups, two independent groups, and many groups settings. The techniques described for each setting will vary slightly, but you will be well served to find the structural similarities across the different settings.</p>

  <p>Similar to how we can model the behavior of the sample proportion <m>\hat{p}</m> using a normal distribution, the sample mean <m>\bar{x}</m> can also be modeled using a normal distribution when certain conditions are met. <idx><h>point estimate</h><h>single mean</h></idx> However, we'll soon learn that a new distribution, called the <m>t</m>-distribution, is more useful when working with the sample mean. We'll first learn about this new distribution, then we'll use it for confidence intervals and hypothesis tests for the mean.</p>

  <section xml:id="sec-boot1mean">
    <title>Bootstrap confidence interval for a mean</title>

    <p>Consider a situation where you want to know whether you should buy a franchise of the used car store Awesome Autos. As part of your planning, you'd like to know for how much an average car from Awesome Autos sells. In order to go through the example more clearly, let's say that you are only able to randomly sample five cars from Awesome Auto. (If this were a real example, you would surely be able to take a much larger sample size, possibly even being able to measure the entire population!)</p>

    <subsection xml:id="subsec-boot1mean-observed">
      <title>Observed data</title>

      <p><xref ref="fig-5cars"/> shows a (small) random sample of observations from Awesome Auto. The actual cars as well as their selling price are shown.</p>

      <figure xml:id="fig-5cars">
        <caption>A sample of five cars from Awesome Auto.</caption>
        <image source="images/5cars.png" width="70%"/>
      </figure>

      <listing xml:id="code-aa-cars-data">
        <caption>Creating the Awesome Auto car data</caption>
        <program language="r">
          <input>
aa_cars &lt;- data.frame(price = c(18300, 20100, 9600, 10700, 27000))
          </input>
        </program>
      </listing>

      <p>The sample average car price of $17,140.00 is a first guess at the price of the average car price at Awesome Auto. However, as a student of statistics, you understand that one sample mean based on a sample of five observations will not necessarily equal the true population average car price for all the cars at Awesome Auto. Indeed, you can see that the observed car prices vary with a standard deviation of $7,170.29, and surely the average car price would be different if a different sample of size five had been taken from the population. Fortunately, as it did in previous chapters for the sample proportion, bootstrapping will approximate the variability of the sample mean from sample to sample.</p>
    </subsection>

    <subsection xml:id="subsec-boot1mean-variability">
      <title>Variability of the statistic</title>

      <p>As with the inferential ideas covered in <xref ref="ch11-hypothesis-testing-randomization"/>, <xref ref="ch12-confidence-intervals-bootstrapping"/>, and <xref ref="sec-foundations-mathematical"/>, the inferential analysis methods in this chapter are grounded in quantifying how one dataset differs from another when they are both taken from the same population. To repeat, the idea is that we want to know how datasets differ from one another, but we aren't ever going to take more than one sample of observations. It does not make sense to take repeated samples from the same population because if you have the ability to take more samples, a larger sample size will benefit you more than taking two samples from the population. Instead, of taking repeated samples from the actual population, we use bootstrapping to measure how the samples behave under an estimate of the population.</p>

      <p>As mentioned previously, to get a sense of the cars at Awesome Auto, you take a sample of five cars from the Awesome Auto branch near you as a way to gauge the price of the cars being sold. <xref ref="fig-bootpop1mean"/> shows how the unknown population of car prices at Awesome Auto can be approximated using the sample.</p>

      <figure xml:id="fig-bootpop1mean">
        <caption>As seen previously, the idea behind bootstrapping is to consider the sample at hand as an estimate of the population. Sampling from the sample (of 5 cars) is identical to sampling from an infinite population which is made up of only the cars in the original sample.</caption>
        <image source="images/bootpop1mean.png" width="70%"/>
      </figure>

      <p>By taking repeated samples from the estimated population, the variability from sample to sample can be observed. In the figure showing bootstrap samples the repeated bootstrap samples are seen to be different both from each other and from the original population. Recall that the bootstrap samples were taken from the same (estimated) population, and so the differences in bootstrap samples are due entirely to natural variability in the sampling procedure. For the situation at hand where the sample mean is the statistic of interest, the variability from sample to sample can be seen in <xref ref="fig-bootsamps1mean"/>.</p>

      <figure xml:id="fig-bootsamps1mean">
        <caption>To estimate the natural variability in the sample mean, different bootstrap samples are taken from the original sample. Notice that each bootstrap resample is different from each other as well as from the original sample</caption>
        <image source="images/bootsamps1mean.png" width="70%"/>
      </figure>

      <p>By summarizing each of the bootstrap samples (here, using the sample mean), we see, directly, the variability of the sample mean, <m>\bar{x},</m> from sample to sample. The distribution of <m>\bar{x}_{bs}</m> for the Awesome Auto cars is shown in <xref ref="fig-bootmeans1mean"/>.</p>

      <figure xml:id="fig-bootmeans1mean">
        <caption>Because each of the bootstrap resamples represents a different set of cars, the mean of the each bootstrap resample will be a different value. Each of the bootstrapped means is calculated, and a histogram of the values describes the inherent natural variability of the sample mean which is due to the sampling process.</caption>
        <image source="images/bootmeans1mean.png" width="100%"/>
      </figure>

      <p><xref ref="fig-carsbsmean"/> summarizes one thousand bootstrap samples in a histogram of the bootstrap sample means. The bootstrapped average car prices vary from about $10,000 to $25,000. The bootstrap percentile confidence interval is found by locating the middle 90% (for a 90% confidence interval) or a 95% (for a 95% confidence interval) of the bootstrapped statistics.</p>

      <exercise xml:id="ex-boot-ci-cars">
        <statement>
          <p>Using <xref ref="fig-carsbsmean"/>, find the 90% and 95% bootstrap percentile confidence intervals for the true average price of a car from Awesome Auto.</p>
        </statement>
        <solution>
          <p>A 90% confidence interval is $12,140 to $22,007. The conclusion is that we are 90% confident that the true average car price at Awesome Auto lies somewhere between $12,140 and $22,007.</p>

          <p>A 95% confidence interval is $11,778 to $22,500. The conclusion is that we are 95% confident that the true average car price at Awesome Auto lies somewhere between $11,778 to $22,500.</p>
        </solution>
      </exercise>

      <figure xml:id="fig-carsbsmean">
        <caption>The original Awesome Auto data is bootstrapped 1,000 times. The histogram provides a sense for the variability of the average car prices from sample to sample.</caption>
        <image source="images/carsbsmean.png" width="90%"/>
      </figure>
    </subsection>

    <subsection xml:id="subsec-boot1mean-se-interval">
      <title>Bootstrap SE confidence interval</title>

      <p>As seen in <xref ref="sec-two-prop-boot-ci"/>, another method for creating bootstrap confidence intervals directly uses a calculation of the variability of the bootstrap statistics (here, the bootstrap means). If the bootstrap distribution is relatively symmetric and bell-shaped, then the 95% bootstrap SE confidence interval can be constructed with the formula familiar from the mathematical models in previous chapters:</p>

      <me>\mbox{point estimate} \pm 2 \cdot SE_{BS}</me>

      <p>The number 2 is an approximation connected to the "95%" part of the confidence interval (remember the 68-95-99.7 rule). As will be seen in <xref ref="sec-one-mean-math"/>, a new distribution (the <m>t</m>-distribution) will be applied to most mathematical inference on numerical variables. However, because bootstrapping is not grounded in the same theory as the mathematical approach given in this text, we stick with the standard normal quantiles (in R use the function <c>qnorm()</c> to find normal percentiles other than 95%) for different confidence percentages.</p>

      <exercise xml:id="ex-boot-se-explanation">
        <statement>
          <p>Explain how the standard error (SE) of the bootstrapped means is calculated and what it is measuring.</p>
        </statement>
        <solution>
          <p>The SE of the bootstrapped means measures how variable the means are from resample to resample. The bootstrap SE is a good approximation to the SE of means as if we had taken repeated samples from the original population (which we agreed isn't something we would do because of wasted resources).</p>

          <p>Logistically, we can find the standard deviation of the bootstrapped means using the same calculations from <xref ref="ch05-exploring-numerical"/>. That is, the bootstrapped means are the individual observations about which we measure the variability.</p>
        </solution>
      </exercise>

      <p>Although we won't spend a lot of energy on this concept, you may be wondering some of the differences between a standard error and a standard deviation. The <alert>standard error</alert><idx>standard error</idx><idx>standard error (SE)</idx> describes how a statistic (e.g., sample mean or sample proportion) varies from sample to sample. The <alert>standard deviation</alert><idx>standard deviation</idx> can be thought of as a function applied to any list of numbers which measures how far those numbers vary from their own average. So, you can have a standard deviation calculated on a column of dog heights or a standard deviation calculated on a column of bootstrapped means from the resampled data. Note that the standard deviation calculated on the bootstrapped means is referred to as the bootstrap standard error of the mean.</p>

      <exercise xml:id="ex-boot-se-ci-calculation">
        <statement>
          <p>It turns out that the standard deviation of the bootstrapped means from <xref ref="fig-carsbsmean"/> is $2,891.87 (a value which is an excellent approximation for the standard error of sample means if we were to take repeated samples from the population). (Note: in R the calculation was done using the function <c>sd()</c>.) The average of the observed prices is $17,140, and we will consider the sample average to be the best guess point estimate for <m>\mu.</m> Find and interpret the confidence interval for <m>\mu</m> (the true average cost of a car at Awesome Auto) using the bootstrap SE confidence interval formula.</p>
        </statement>
        <solution>
          <p>Using the formula for the bootstrap SE interval, we find the 95% confidence interval for <m>\mu</m> is: <m>17,140 \pm 2 \cdot 2,891.87 \rightarrow</m> ($11,356.26, $22,923.74). We are 95% confident that the true average car price at Awesome Auto is somewhere between $11,356.26 and $22,923.74.</p>
        </solution>
      </exercise>

      <exercise xml:id="ex-boot-compare-methods">
        <statement>
          <p>Compare and contrast the two different 95% confidence intervals for <m>\mu</m> created by finding the percentiles of the bootstrapped means and created by finding the SE of the bootstrapped means. Do you think the intervals <em>should</em> be identical?</p>
        </statement>
        <solution>
          <p><ul>
            <li><p>Percentile interval: ($11,778, $22,500)</p></li>
            <li><p>SE interval: ($11,356.26, $22,923.74)</p></li>
          </ul></p>

          <p>The intervals were created using different methods, so it is not surprising that they are not identical. However, we are pleased to see that the two methods provide very similar interval approximations. The technical details surrounding which data structures are best for percentile intervals and which are best for SE intervals is beyond the scope of this text. However, the larger the samples are, the better (and closer) the interval estimates will be.</p>
        </solution>
      </exercise>
    </subsection>

    <subsection xml:id="subsec-boot1mean-sd-ci">
      <title>Bootstrap percentile confidence interval for a standard deviation</title>

      <p>Suppose that we want to understand how variable the prices of the cars are at Awesome Auto. That is, your interest is no longer in the average car price but in the <em>standard deviation</em> of the prices of all cars at Awesome Auto, <m>\sigma.</m> You may have already realized that the sample standard deviation, <m>s,</m> will work as a good <alert>point estimate</alert><idx>point estimate</idx> for the parameter of interest: the population standard deviation, <m>\sigma.</m> The point estimate of the five observations is calculated to be <m>s = \$7,170.286.</m> While <m>s = \$7,170.286</m> might be a good guess for <m>\sigma,</m> we prefer to have an interval estimate for the parameter of interest. Although there is a mathematical model which describes how <m>s</m> varies from sample to sample, the mathematical model will not be presented in this text. Instead, bootstrapping can be used to find a confidence interval for the parameter <m>\sigma.</m> Using the same technique as presented for a confidence interval for <m>\mu,</m> here we find the bootstrap percentile confidence interval for <m>\sigma.</m></p>

      <exercise xml:id="ex-boot-sd-describe">
        <statement>
          <p>Describe the bootstrap distribution for the standard deviation shown in <xref ref="fig-carsbssd"/>.</p>
        </statement>
        <solution>
          <p>The distribution is skewed left and centered near $7,170.286, which is the point estimate from the original data. Most observations in this distribution lie between $0 and $10,000.</p>
        </solution>
      </exercise>

      <exercise xml:id="ex-boot-sd-ci">
        <statement>
          <p>Using <xref ref="fig-carsbssd"/>, find and interpret a 90% bootstrap percentile confidence interval for the population standard deviation for car prices at Awesome Auto.</p>
        </statement>
        <solution>
          <p>Based on the percentile values in <xref ref="fig-carsbssd"/>, the middle 90% of the bootstrapped standard deviations is given by the 5th ($3,602.5) and the 95th percentiles ($8,737.2). That is, we are 90% confident that the true standard deviation of car prices is between $3,602.5 and $8,737.2. A 90% confidence level indicates that there was not a need for a high level of confidence, such a 95% or 99%. A lower confidence level has higher potential for error, but it also produces a narrower interval.</p>
        </solution>
      </exercise>

      <figure xml:id="fig-carsbssd">
        <caption>The original Awesome Auto data is bootstrapped 1,000 times. The histogram provides a sense for the variability of the standard deviation of car prices from sample to sample.</caption>
        <image source="images/carsbssd.png" width="90%"/>
      </figure>
    </subsection>

    <subsection xml:id="subsec-boot1mean-limitations">
      <title>Bootstrapping is not a solution to small sample sizes!</title>

      <p>The example presented above is done for a sample with only five observations. As with analysis techniques that build on mathematical models, bootstrapping works best when a large random sample has been taken from the population. Bootstrapping is a method for capturing the variability of a statistic when the mathematical model is unknown (it is not a method for navigating small samples). As you might guess, the larger the random sample, the more accurately that sample will represent the population of interest.</p>
    </subsection>
  </section>

  <section xml:id="sec-one-mean-math">
    <title>Mathematical model for a mean</title>

    <p>As with the sample proportion, the variability of the sample mean is well described by the mathematical theory given by the Central Limit Theorem. However, because of missing information about the inherent variability in the population (<m>\sigma</m>), a <m>t</m>-distribution is used in place of the standard normal when performing hypothesis test or confidence interval analyses.</p>

    <subsection xml:id="subsec-one-mean-sampling-dist">
      <title>Mathematical distribution of the sample mean</title>

      <p>The sample mean tends to follow a normal distribution centered at the population mean, <m>\mu,</m> when certain conditions are met. Additionally, we can compute a standard error for the sample mean using the population standard deviation <m>\sigma</m> and the sample size <m>n.</m></p>

      <assemblage xml:id="clt-mean">
        <title>Central Limit Theorem for the sample mean</title>
        <p>When we collect a sufficiently large sample of <m>n</m> independent observations from a population with mean <m>\mu</m> and standard deviation <m>\sigma,</m> the sampling distribution of <m>\bar{x}</m> will be nearly normal with</p>

        <p><idx><h>point estimate</h><h>single mean</h></idx><idx><h>single mean</h><h>point estimate</h></idx><idx><h>standard error (SE)</h><h>single mean</h></idx><idx><h>single mean</h><h>standard error (SE)</h></idx></p>

        <me>\text{Mean} = \mu \qquad \text{Standard Error }(SE) = \frac{\sigma}{\sqrt{n}}</me>
      </assemblage>

      <p>Before diving into confidence intervals and hypothesis tests using <m>\bar{x},</m> we first need to cover two topics:</p>

      <p><ul>
        <li><p>When we modeled <m>\hat{p}</m> using the normal distribution, certain conditions had to be satisfied. The conditions for working with <m>\bar{x}</m> are a little more complex, and below, we will discuss how to check conditions for inference using a mathematical model.</p></li>
        <li><p>The standard error is dependent on the population standard deviation, <m>\sigma.</m> However, we rarely know <m>\sigma,</m> and instead we must estimate it. Because this estimation is itself imperfect, we use a new distribution called the <m>t</m>-distribution to fix this problem.</p></li>
      </ul></p>

      <p><idx>t-distribution</idx></p>
    </subsection>

    <subsection xml:id="subsec-one-mean-conditions">
      <title>Evaluating the two conditions required for modeling <m>\bar{x}</m></title>

      <p>Two conditions are required to apply the Central Limit Theorem<idx>Central Limit Theorem</idx> for a sample mean <m>\bar{x}:</m></p>

      <p><ul>
        <li><p><alert>Independence.</alert> The sample observations must be independent. The most common way to satisfy this condition is when the sample is a simple random sample from the population. If the data come from a random process, analogous to rolling a die, this would also satisfy the independence condition.</p></li>

        <li><p><alert>Normality.</alert> When a sample is small, we also require that the sample observations come from a normally distributed population. We can relax this condition more and more for larger and larger sample sizes. This condition is vague, making it difficult to evaluate, so next we introduce a couple rules of thumb to checking it.</p></li>
      </ul></p>

      <assemblage xml:id="normality-check-rule">
        <title>General rule for performing the normality check</title>
        <p>There is no perfect way to check the normality condition, so instead we use two general rules based on the number and magnitude of extreme observations. Note, it often takes practice to get a sense for whether a normal approximation is appropriate.</p>

        <ul>
          <li><p>Small <m>n</m>: If the sample size <m>n</m> is small and there are <alert>no clear outliers</alert> in the data, then we typically assume the data come from a nearly normal distribution to satisfy the condition.</p></li>
          <li><p>Large <m>n</m>: If the sample size <m>n</m> is large and there are no <alert>particularly extreme</alert> outliers, then we typically assume the sampling distribution of <m>\bar{x}</m> is nearly normal, even if the underlying distribution of individual observations is not.</p></li>
        </ul>

        <p>Some guidelines for determining whether <m>n</m> is considered small or large are as follows: slight skew is okay for sample sizes of 15, moderate skew for sample sizes of 30, and strong skew for sample sizes of 60.</p>
      </assemblage>

      <p>In this first course in statistics, you aren't expected to develop perfect judgment on the normality condition. However, you are expected to be able to handle clear cut cases based on the rules of thumb.</p>

      <exercise xml:id="ex-check-conditions-two-samples">
        <statement>
          <p>Consider the four plots provided in <xref ref="fig-outliersandsscondition"/> that come from simple random samples from different populations. Their sample sizes are <m>n_1 = 15</m> and <m>n_2 = 50.</m></p>

          <p>Are the independence and normality conditions met in each case?</p>
        </statement>
        <solution>
          <p>Each samples is from a simple random sample of its respective population, so the independence condition is satisfied. Let's next check the normality condition for each using the rule of thumb.</p>

          <p>The first sample has fewer than 30 observations, so we are watching for any clear outliers. None are present; while there is a small gap in the histogram on the right, this gap is small and over 20% of the observations in this small sample are represented to the left of the gap, so we can hardly call these clear outliers. With no clear outliers, the normality condition can be reasonably assumed to be met.</p>

          <p>The second sample has a sample size greater than 30 and includes an outlier that appears to be roughly 5 times further from the center of the distribution than the next furthest observation. This is an example of a particularly extreme outlier, so the normality condition would not be satisfied.</p>

          <p>It's often helpful to also visualize the data using a box plot to assess skewness and existence of outliers. The box plots provided underneath each histogram confirms our conclusions that the first sample does not have any outliers and the second sample does, with one outlier being particularly more extreme than the others.</p>
        </solution>
      </exercise>

      <figure xml:id="fig-outliersandsscondition">
        <caption>Histograms of samples from two different populations.</caption>
        <image source="images/outliersandsscondition.png" width="70%"/>
      </figure>

      <p>In practice, it's typical to also do a mental check to evaluate whether we have reason to believe the underlying population would have moderate skew (if <m>n &lt; 30)</m> or have particularly extreme outliers <m>(n \geq 30)</m> beyond what we observe in the data. For example, consider the number of followers for each individual account on Twitter, and then imagine this distribution. The large majority of accounts have built up a couple thousand followers or fewer, while a relatively tiny fraction have amassed tens of millions of followers, meaning the distribution is extremely skewed. When we know the data come from such an extremely skewed distribution, it takes some effort to understand what sample size is large enough for the normality condition to be satisfied.</p>

      <p><idx>Central Limit Theorem</idx></p>
    </subsection>

    <subsection xml:id="subsec-intro-tdist">
      <title>Introducing the t-distribution</title>

      <p><idx>t-distribution</idx></p>

      <p>In practice, we cannot directly calculate the standard error for <m>\bar{x}</m> since we do not know the population standard deviation, <m>\sigma.</m> We encountered a similar issue when computing the standard error for a sample proportion, which relied on the population proportion, <m>p.</m> Our solution in the proportion context was to use the sample value in place of the population value when computing the standard error. We'll employ a similar strategy for computing the standard error of <m>\bar{x},</m> using the sample standard deviation <m>s</m> in place of <m>\sigma:</m></p>

      <me>SE = \frac{\sigma}{\sqrt{n}} \approx \frac{s}{\sqrt{n}}</me>

      <p>This strategy tends to work well when we have a lot of data and can estimate <m>\sigma</m> using <m>s</m> accurately. However, the estimate is less precise with smaller samples, and this leads to problems when using the normal distribution to model <m>\bar{x}.</m></p>

      <p>We'll find it useful to use a new distribution for inference calculations called the <m>t</m>-distribution. A <m>t</m>-distribution, shown as a solid line in <xref ref="fig-tDistCompareToNormalDist"/>, has a bell shape. However, its tails are thicker than the normal distribution's, meaning observations are more likely to fall beyond two standard deviations from the mean than under the normal distribution.</p>

      <p>The extra thick tails of the <m>t</m>-distribution are exactly the correction needed to resolve the problem (due to extra variability of the T score) of using <m>s</m> in place of <m>\sigma</m> in the <m>SE</m> calculation.</p>

      <figure xml:id="fig-tDistCompareToNormalDist">
        <caption>Comparison of a <m>t</m>-distribution and a normal distribution.</caption>
        <image source="images/tDistCompareToNormalDist.png" width="60%"/>
      </figure>

      <p>The <m>t</m>-distribution is always centered at zero and has a single parameter: degrees of freedom. The <alert>degrees of freedom</alert><idx>degrees of freedom</idx><idx><h>degrees of freedom</h><h>single mean</h></idx> describes the precise form of the bell-shaped <m>t</m>-distribution. Several <m>t</m>-distributions are shown in <xref ref="fig-tDistConvergeToNormalDist"/> in comparison to the normal distribution. Similar to the Chi-square distribution, the shape of the <m>t</m>-distribution also depends on the degrees of freedom.</p>

      <p>In general, we'll use a <m>t</m>-distribution with <m>df = n - 1</m> to model the sample mean when the sample size is <m>n.</m> That is, when we have more observations, the degrees of freedom will be larger and the <m>t</m>-distribution will look more like the standard normal distribution; when the degrees of freedom is about 30 or more, the <m>t</m>-distribution is nearly indistinguishable from the normal distribution.</p>

      <figure xml:id="fig-tDistConvergeToNormalDist">
        <caption>The larger the degrees of freedom, the more closely the <m>t</m>-distribution resembles the standard normal distribution.</caption>
        <image source="images/tDistConvergeToNormalDist.png" width="60%"/>
      </figure>

      <assemblage xml:id="df-definition">
        <title>Degrees of freedom: df</title>
        <p>The degrees of freedom describes the shape of the <m>t</m>-distribution. The larger the degrees of freedom, the more closely the distribution approximates the normal distribution.</p>

        <p>When modeling <m>\bar{x}</m> using the <m>t</m>-distribution, use <m>df = n - 1.</m></p>
      </assemblage>

      <p>The <m>t</m>-distribution allows us greater flexibility than the normal distribution when analyzing numerical data. In practice, it's common to use statistical software, such as R, Python, or SAS for these analyses. In R, the function used for calculating probabilities under a <m>t</m>-distribution is <c>pt()</c> (which should seem similar to previous R functions, <c>pnorm()</c> and <c>pchisq()</c>). Don't forget that with the <m>t</m>-distribution, the degrees of freedom must always be specified!</p>

      <p>For the examples and guided practices below, you may have to use a table or statistical software to find the answers. We recommend trying the problems so as to get a sense for how the <m>t</m>-distribution can vary in width depending on the degrees of freedom. No matter the approach you choose, apply your method using the examples below to confirm your working understanding of the <m>t</m>-distribution.</p>

      <exercise xml:id="ex-tdist-df18-left">
        <statement>
          <p>What proportion of the <m>t</m>-distribution with 18 degrees of freedom falls below -2.10?</p>
        </statement>
        <solution>
          <p>Let's first draw the picture and shade the area below -2.10.</p>

          <figure xml:id="fig-tDistDF18LeftTail2Point10">
            <caption>A t distribution with 18 degrees of freedom. The area below -2.10 has been shaded.</caption>
            <image source="images/tDistDF18LeftTail2Point10.png" width="60%"/>
          </figure>

          <p>Using statistical software, we can obtain a precise value: 0.0250.</p>

          <listing xml:id="code-pt-example-1">
            <caption>Using pt() to find probability under the t-distribution</caption>
            <program language="r">
              <input>
# use pt() to find probability under the t-distribution
pt(-2.10, df = 18)
              </input>
            </program>
          </listing>
        </solution>
      </exercise>

      <exercise xml:id="ex-tdist-df20-right">
        <statement>
          <p>What proportion of the <m>t</m>-distribution with 20 degrees of freedom falls above 1.65?</p>
        </statement>
        <solution>
          <p>Note that with 20 degrees of freedom, the <m>t</m>-distribution is relatively close to the normal distribution. With a normal distribution, this would correspond to about 0.05, so we should expect the <m>t</m>-distribution to give us a similar value. Using statistical software, we can obtain a precise value: 0.0573.</p>

          <listing xml:id="code-pt-example-2">
            <caption>Using pt() to find probability under the t-distribution</caption>
            <program language="r">
              <input>
# use pt() to find probability under the t-distribution
1 - pt(1.65, df = 20)
              </input>
            </program>
          </listing>
        </solution>
      </exercise>

      <exercise xml:id="ex-tdist-df2-both-tails">
        <statement>
          <p>A <m>t</m>-distribution with 2 degrees of freedom is shown below. Estimate the proportion of the distribution falling more than 3 units from the mean (above or below).</p>

          <figure xml:id="fig-tDistDF23UnitsFromMean">
            <caption>A t distribution with 2 degrees of freedom. The area below negative 3 and above positive 3 has been shaded.</caption>
            <image source="images/tDistDF23UnitsFromMean.png" width="60%"/>
          </figure>
        </statement>
        <solution>
          <p>With so few degrees of freedom, the <m>t</m>-distribution will give a more notably different value than the normal distribution. Under a normal distribution, the area would be about 0.003 using the 68-95-99.7 rule. For a <m>t</m>-distribution with <m>df = 2,</m> the area in both tails beyond 3 units totals 0.0955. This area is dramatically different than what we obtain from the normal distribution.</p>

          <listing xml:id="code-pt-example-3">
            <caption>Using pt() to find probability under the t-distribution</caption>
            <program language="r">
              <input>
# use pt() to find probability under the t-distribution
pt(-3, df = 2) + (1 - pt(3, df = 2))
              </input>
            </program>
          </listing>
        </solution>
      </exercise>

      <exercise xml:id="ex-tdist-df19-above">
        <statement>
          <p>What proportion of the <m>t</m>-distribution with 19 degrees of freedom falls above -1.79 units? Use your preferred method for finding tail areas.</p>
        </statement>
        <solution>
          <p>We want to find the shaded area <em>above</em> -1.79 (we leave the picture to you). The lower tail area has an area of 0.0447, so the upper area would have an area of <m>1 - 0.0447 = 0.9553.</m></p>
        </solution>
      </exercise>

      <p><idx>t-distribution</idx></p>
    </subsection>

    <subsection xml:id="subsec-one-sample-t-ci">
      <title>One sample t-intervals</title>

      <p>Let's get our first taste of applying the <m>t</m>-distribution in the context of an example about the mercury content of dolphin muscle. Elevated mercury concentrations are an important problem for both dolphins and other animals, like humans, who occasionally eat them.</p>

      <figure xml:id="fig-rissosDolphin">
        <caption>A Risso's dolphin. Photo by Mike Baird, www.bairdphotos.com. CC BY 2.0 license.</caption>
        <image source="images/rissosDolphin.jpg" width="65%"/>
      </figure>

      <p>We will identify a confidence interval for the average mercury content in dolphin muscle using a sample of 19 Risso's dolphins from the Taiji area in Japan. The data are summarized in <xref ref="tbl-summaryStatsOfHgInMuscleOfRissosDolphins"/>. The minimum and maximum observed values can be used to evaluate whether there are clear outliers.</p>

      <table xml:id="tbl-summaryStatsOfHgInMuscleOfRissosDolphins">
        <title>Summary of mercury content in the muscle of 19 Risso's dolphins from the Taiji area. Measurements are in micrograms of mercury per wet gram of muscle (<m>\mu\text{g/wet g}</m>).</title>
        <tabular>
          <row header="yes">
            <cell>n</cell>
            <cell>Mean</cell>
            <cell>SD</cell>
            <cell>Min</cell>
            <cell>Max</cell>
          </row>
          <row>
            <cell>19</cell>
            <cell>4.4</cell>
            <cell>2.3</cell>
            <cell>1.7</cell>
            <cell>9.2</cell>
          </row>
        </tabular>
      </table>

      <exercise xml:id="ex-dolphin-conditions">
        <statement>
          <p>Are the independence and normality conditions satisfied for this dataset?</p>
        </statement>
        <solution>
          <p>The observations are a simple random sample, therefore it is reasonable to assume that the dolphins are independent. The summary statistics in <xref ref="tbl-summaryStatsOfHgInMuscleOfRissosDolphins"/> do not suggest any clear outliers, with all observations within 2.5 standard deviations of the mean. Based on this evidence, the normality condition seems reasonable.</p>
        </solution>
      </exercise>

      <p>In the normal model, we used <m>z^{\star}</m> and the standard error to determine the width of a confidence interval. We revise the confidence interval formula slightly when using the <m>t</m>-distribution:</p>

      <md>
        <mrow>\text{point estimate} \ &amp;\pm\  t^{\star}_{df} \times SE</mrow>
        <mrow>\bar{x} \ &amp;\pm\  t^{\star}_{df} \times \frac{s}{\sqrt{n}}</mrow>
      </md>

      <exercise xml:id="ex-dolphin-se">
        <statement>
          <p>Using the summary statistics in <xref ref="tbl-summaryStatsOfHgInMuscleOfRissosDolphins"/>, compute the standard error for the average mercury content in the <m>n = 19</m> dolphins.</p>
        </statement>
        <solution>
          <p>We plug in <m>s</m> and <m>n</m> into the formula: <m>SE = \frac{s}{\sqrt{n}} = \frac{2.3}{\sqrt{19}} = 0.528.</m></p>
        </solution>
      </exercise>

      <p>The value <m>t^{\star}_{df}</m> is a cutoff we obtain based on the confidence level and the <m>t</m>-distribution with <m>df</m> degrees of freedom. That cutoff is found in the same way as with a normal distribution: we find <m>t^{\star}_{df}</m> such that the fraction of the <m>t</m>-distribution with <m>df</m> degrees of freedom within a distance <m>t^{\star}_{df}</m> of 0 matches the confidence level of interest.</p>

      <exercise xml:id="ex-dolphin-tstar">
        <statement>
          <p>When <m>n = 19,</m> what is the appropriate degrees of freedom? Find <m>t^{\star}_{df}</m> for this degrees of freedom and the confidence level of 95%</p>
        </statement>
        <solution>
          <p>The degrees of freedom is easy to calculate: <m>df = n - 1 = 18.</m></p>

          <p>Using statistical software, we find the cutoff where the upper tail is equal to 2.5%: <m>t^{\star}_{18} = 2.10.</m> The area below -2.10 will also be equal to 2.5%. That is, 95% of the <m>t</m>-distribution with <m>df = 18</m> lies within 2.10 units of 0.</p>

          <listing xml:id="code-qt-dolphin">
            <caption>Using qt() to find the t-cutoff (with 95% in the middle)</caption>
            <program language="r">
              <input>
# use qt() to find the t-cutoff (with 95% in the middle)
qt(0.025, df = 18)
qt(0.975, df = 18)
              </input>
            </program>
          </listing>
        </solution>
      </exercise>

      <assemblage xml:id="df-single-sample">
        <title>Degrees of freedom for a single sample</title>
        <p>If the sample has <m>n</m> observations and we are examining a single mean, then we use the <m>t</m>-distribution with <m>df=n-1</m> degrees of freedom.</p>
      </assemblage>

      <exercise xml:id="ex-dolphin-ci">
        <statement>
          <p>Compute and interpret the 95% confidence interval for the average mercury content in Risso's dolphins.</p>
        </statement>
        <solution>
          <p>We can construct the confidence interval as</p>

          <md>
            <mrow>\bar{x} \ &amp;\pm\  t^{\star}_{18} \times SE</mrow>
            <mrow>4.4 \ &amp;\pm\  2.10 \times 0.528</mrow>
            <mrow>(3.29 \  &amp;, \ 5.51)</mrow>
          </md>

          <p>We are 95% confident the average mercury content of muscles in Risso's dolphins is between 3.29 and 5.51 <m>\mu\text{g/wet g}</m>, which is considered extremely high.</p>
        </solution>
      </exercise>

      <assemblage xml:id="t-ci-formula">
        <title>Calculating a <m>t</m>-confidence interval for the mean, <m>\mu</m></title>
        <p><idx><h>t-CI</h><h>single mean</h></idx></p>

        <p>Based on a sample of <m>n</m> independent and nearly normal observations, a confidence interval for the population mean is</p>

        <md>
          <mrow>\text{point estimate} \ &amp;\pm\  t^{\star}_{df} \times SE</mrow>
          <mrow>\bar{x} \ &amp;\pm\  t^{\star}_{df} \times \frac{s}{\sqrt{n}}</mrow>
        </md>

        <p>where <m>\bar{x}</m> is the sample mean, <m>t^{\star}_{df}</m> corresponds to the confidence level and degrees of freedom <m>df,</m> and <m>SE</m> is the standard error as estimated by the sample.</p>
      </assemblage>

      <exercise xml:id="ex-croaker-conditions">
        <statement>
          <p>The FDA's webpage provides some data on mercury content of fish. Based on a sample of 15 croaker white fish (Pacific), a sample mean and standard deviation were computed as 0.287 and 0.069 ppm (parts per million), respectively. The 15 observations ranged from 0.18 to 0.41 ppm. We will assume these observations are independent. Based on the summary statistics of the data, do you have any objections to the normality condition of the individual observations?</p>
        </statement>
        <solution>
          <p>The sample size is under 30, so we check for obvious outliers: since all observations are within 2 standard deviations of the mean, there are no such clear outliers.</p>
        </solution>
      </exercise>

      <exercise xml:id="ex-croaker-se-tstar">
        <statement>
          <p>Estimate the standard error of <m>\bar{x} = 0.287</m> ppm using the data summaries in the previous Guided Practice. If we are to use the <m>t</m>-distribution to create a 90% confidence interval for the actual mean of the mercury content, identify the degrees of freedom and <m>t^{\star}_{df}.</m></p>
        </statement>
        <solution>
          <p>The standard error: <m>SE = \frac{0.069}{\sqrt{15}} = 0.0178.</m> Degrees of freedom: <m>df = n - 1 = 14.</m> Since the goal is a 90% confidence interval, we choose <m>t_{14}^{\star}</m> so that the two-tail area is 0.1: <m>t^{\star}_{14} = 1.76.</m></p>

          <listing xml:id="code-qt-croaker">
            <caption>Using qt() to find the t-cutoff (with 90% in the middle)</caption>
            <program language="r">
              <input>
# use qt() to find the t-cutoff (with 90% in the middle)
qt(0.05, df = 14)
qt(0.95, df = 14)
              </input>
            </program>
          </listing>
        </solution>
      </exercise>

      <exercise xml:id="ex-croaker-ci">
        <statement>
          <p>Using the information and results of the previous Guided Practice and Example, compute a 90% confidence interval for the average mercury content of croaker white fish (Pacific).</p>
        </statement>
        <solution>
          <p><m>\bar{x} \ \pm\ t^{\star}_{14} \times SE \ \to\  0.287 \ \pm\  1.76 \times 0.0178 \ \to\ (0.256, 0.318).</m> We are 90% confident that the average mercury content of croaker white fish (Pacific) is between 0.256 and 0.318 ppm.</p>
        </solution>
      </exercise>

      <exercise xml:id="ex-croaker-interpretation">
        <statement>
          <p>The 90% confidence interval from the previous Guided Practice is 0.256 ppm to 0.318 ppm. Can we say that 90% of croaker white fish (Pacific) have mercury levels between 0.256 and 0.318 ppm?</p>
        </statement>
        <solution>
          <p>No, a confidence interval only provides a range of plausible values for a population parameter, in this case the population mean. It does not describe what we might observe for individual observations.</p>
        </solution>
      </exercise>

      <p>Recall that the margin of error is defined by the standard error. The margin of error for <m>\bar{x}</m> can be directly obtained from <m>SE(\bar{x}).</m></p>

      <assemblage xml:id="moe-mean">
        <title>Margin of error for <m>\bar{x}</m></title>
        <p>The margin of error is <m>t^\star_{df} \times s/\sqrt{n}</m> where <m>t^\star_{df}</m> is calculated from a specified percentile on the t-distribution with <em>df</em> degrees of freedom.</p>
      </assemblage>
    </subsection>

    <subsection xml:id="subsec-one-sample-t-test">
      <title>One sample t-tests</title>

      <p><idx>t-test</idx></p>

      <p>Now that we have used the <m>t</m>-distribution for making a confidence interval for a mean, let's speed on through to hypothesis tests for the mean.</p>

      <assemblage xml:id="t-test-statistic">
        <title>The test statistic for assessing a single mean is a T</title>
        <p>The T score is a ratio of how the sample mean differs from the hypothesized mean as compared to how the observations vary.</p>

        <me>T = \frac{\bar{x} - \mbox{null value}}{s/\sqrt{n}}</me>

        <p>When the null hypothesis is true and the conditions are met, T has a t-distribution with <m>df = n - 1.</m></p>

        <p>Conditions:</p>
        <ul>
          <li><p>Independent observations.</p></li>
          <li><p>Large samples and no extreme outliers.</p></li>
        </ul>
      </assemblage>

      <p>Is the typical US runner getting faster or slower over time? We consider this question in the context of the Cherry Blossom Race, which is a 10-mile race in Washington, DC each spring. The average time for all runners who finished the Cherry Blossom Race in 2006 was 93.29 minutes (93 minutes and about 17 seconds). We want to determine using data from 100 participants in the 2017 Cherry Blossom Race whether runners in this race are getting faster or slower, versus the other possibility that there has been no change.</p>

      <p>The <c>run17</c> data can be found in the <c>cherryblossom</c> R package.</p>

      <exercise xml:id="ex-cherry-hypotheses">
        <statement>
          <p>What are appropriate hypotheses for this context?</p>
        </statement>
        <solution>
          <p><m>H_0:</m> The average 10-mile run time was the same for 2006 and 2017. <m>\mu = 93.29</m> minutes. <m>H_A:</m> The average 10-mile run time for 2017 was <em>different</em> than that of 2006. <m>\mu \neq 93.29</m> minutes.</p>
        </solution>
      </exercise>

      <p>When completing a hypothesis test for the one-sample mean, the process is nearly identical to completing a hypothesis test for a single proportion. First, we find the Z score using the observed value, null value, and standard error; however, we call it a <alert>T score</alert><idx><h>T score</h><h>single mean</h></idx><idx><h>single mean</h><h>T score</h></idx><idx>T score</idx> since we use a <m>t</m>-distribution for calculating the tail area. Then we find the p-value using the same ideas we used previously: find the one-tail area under the sampling distribution, and double it.</p>

      <p>But first, we check the conditions.</p>

      <exercise xml:id="ex-cherry-conditions">
        <statement>
          <p>The data come from a simple random sample of all participants, so the observations are independent. A histogram of the race times is given below to evaluate if we can move forward with a t-test. Is the normality condition met?</p>

          <figure xml:id="fig-run17-histogram">
            <caption>Histogram of race times</caption>
            <image source="images/run17-histogram.png" width="60%"/>
          </figure>
        </statement>
        <solution>
          <p>With a sample of 100, we should only be concerned if there is are particularly extreme outliers. The histogram of the data does not show any outliers of concern (and arguably, no outliers at all).</p>
        </solution>
      </exercise>

      <exercise xml:id="ex-cherry-test">
        <statement>
          <p>With both the independence and normality conditions satisfied, we can proceed with a hypothesis test using the <m>t</m>-distribution. The sample mean and sample standard deviation of the sample of 100 runners from the 2017 Cherry Blossom Race are 98.8 and 16.6 minutes, respectively. Recall that the average run time in 2006 was 93.29 minutes. Find the test statistic and p-value. What is your conclusion?</p>
        </statement>
        <solution>
          <p>To find the test statistic (T score), we first must determine the standard error:</p>

          <me>SE = 16.6 / \sqrt{100} = 1.66</me>

          <p>Now we can compute the <alert>T score</alert> using the sample mean (98.8), null value (93.29), and <m>SE:</m></p>

          <me>T = \frac{98.8 - 93.29}{1.66} = 3.32</me>

          <p>For <m>df = 100 - 1 = 99,</m> we can determine using statistical software (or a <m>t</m>-table) that the one-tail area is 0.000631, which we double to get the p-value: 0.00126.</p>

          <listing xml:id="code-pt-cherry">
            <caption>Using pt() to find the left tail and multiply by 2 to get both tails</caption>
            <program language="r">
              <input>
# use pt() to find the left tail and multiply by 2 to get both tails
(1 - pt(3.32, df = 99)) * 2
              </input>
            </program>
          </listing>

          <p>Because the p-value is smaller than 0.05, we reject the null hypothesis. That is, the data provide convincing evidence that the average run time for the Cherry Blossom Run in 2017 is different than the 2006 average.</p>
        </solution>
      </exercise>

      <assemblage xml:id="t-score-definition">
        <title>When using a <m>t</m>-distribution, we use a T score (similar to a Z score)</title>
        <p>To help us remember to use the <m>t</m>-distribution, we use a <m>T</m> to represent the test statistic, and we often call this a <alert>T score</alert>. The Z score and T score are computed in the exact same way and are conceptually identical: each represents how many standard errors the observed value is from the null value.</p>
      </assemblage>
    </subsection>
  </section>

  <section xml:id="sec-chp19-review">
    <title>Chapter review</title>

    <subsection xml:id="subsec-chp19-summary">
      <title>Summary</title>

      <p>In this chapter we extended the randomization / bootstrap / mathematical model paradigm to questions involving quantitative variables of interest. When there is only one variable of interest, we are often hypothesizing or finding confidence intervals about the population mean. Note, however, the bootstrap method can be used for other statistics like the population median or the population IQR. When comparing a quantitative variable across two groups, the question often focuses on the difference in population means (or sometimes a paired difference in means). The questions revolving around one, two, and paired samples of means are addressed using the t-distribution; they are therefore called "t-tests" and "t-intervals." When considering a quantitative variable across 3 or more groups, a method called ANOVA is applied. Again, almost all the research questions can be approached using computational methods (e.g., randomization tests or bootstrapping) or using mathematical models. We continue to emphasize the importance of experimental design in making conclusions about research claims. In particular, recall that variability can come from different sources (e.g., random sampling vs. random allocation, see <xref ref="fig-randsampValloc"/>).</p>
    </subsection>

    <subsection xml:id="subsec-chp19-terms">
      <title>Terms</title>

      <p>The terms introduced in this chapter are presented below. If you're not sure what some of these terms mean, we recommend you go back in the text and review their definitions. You should be able to easily spot them as <alert>bolded text</alert>.</p>

      <p><ul>
        <li><p>numerical data</p></li>
        <li><p>SE single mean</p></li>
        <li><p>SD of observations</p></li>
        <li><p>point estimate</p></li>
        <li><p>t-distribution</p></li>
        <li><p>Central Limit Theorem</p></li>
        <li><p>degrees of freedom</p></li>
        <li><p>T score single mean</p></li>
        <li><p>t-test</p></li>
      </ul></p>
    </subsection>
  </section>

</chapter>
